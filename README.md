# ionosphere-predict
<div align="center"> <img src="https://github-readme-stats.vercel.app/api?username=Gnss406ionosphere&show_icons=true&theme=tokyonight" /> </div>
<div align="center"> <img src="https://profile-counter.glitch.me/Gnss406ionosphere/count.svg" /> </div>
# Table of contents

#项目背景：电离层是大气空间层的重要组成部分，其中含有大量的自由电子和离子，穿越其中的无线信号会发生折射，影响卫星定位、导航、授时服务、遥感系统等地空应用系统的精度。在卫星导航定位系统中，电离层会影响卫星信号的传播，严重影响了卫星导航定位的精确度和可靠性。电离层总电子含量（Total Electron Content，TEC）是卫星和接收机之间路径上的自由电子的总数，它是描述电离层形态和结构的一个重要参数，其大小与电离层对卫星信号的影响成正比。因此，利用电离层 TEC 分析电离层的活动，探索它在不同时空尺度的变化规律，进行高精度的全球电离层 TEC 建模与预测研究，可以提供更准确的电离层延迟信息，减轻电离层对卫星信号的影响，提高卫星导航定位的准确性。
近年来深度学习算法表现出了强大的时空特性挖掘能力，因此，本项目利用深度学习算法构造了一个全球电离层 TEC 时空网络模型，进行高精度的全球电离层 TEC 建模与预测。此模型包括前向时空特性传递的全局时空特性提取和反向时空特性传递的区域时空特性修正两个模块。本文模型能够同时学习电离层的时间变化特性和空间特征，实现 TEC 全局时空特性和区域时空特性的互补，保证全球电离层 TEC 全局时空特性同时在时间域和空间域内相互传递，拟合其中的时空相关性等非线性关系，同时，采用 Huber 损失函数抑制电离层 TEC 数据中的粗差和噪声，提高全球电离层 TEC 的预测精度。
接下来验证了在不同时间点和不同太阳活动条件下，全球电离层 TEC 时空网络模型的预测性能，实验结果表明，无论在内部精度验证或外部精度验证条件下，本模型均具有较高的预测性能，并具有一定的泛化能力。这个方法能进一步提高全球电离层 TEC的预测精度，可有效服务于卫星导航定位中的电离层延迟误差改正。

#模型介绍：本项目使用 ST-LSTM 单元学习全球电离层 TEC 时空特性的同时，建立前向时空特性传递的全局时空特性提取和反向时空特性传递的区域时空特性修正两个模块，构造全球电离层 TEC 时空网络模型，使用顶层 STLSTM 单元提取的全局时空特性，弥补前几层 ST-LSTM 单元的区域时空特性，实现 TEC 全局时空特性和区域时空特性的互补，保证每一层 ST-LSTM 单元都含有丰富的全球电离层 TEC 全局时空特性传递给下一时刻，提高了模型对全球电离层 TEC 的时空相关性等非线性关系的拟合性能。时空网络模型每个时刻由四层 ST-LSTM 单元堆叠构成，每层 ST-LSTM 单元中卷积核数量为 64，大小为 5×5，输入数据为全球电离层TEC 的历史观测序列，而输出数据则为全球电离层 TEC 的预测序列。模型包括电离层 TEC 时空特性逐层向上传递的全局时空特性提取以及全局时空特性逐层向下传递的区域时空特性修正两个模块。最终的全球电离层 TEC 预测结果仍由第四层的全局时空特性计算得出。总体而言，全球电离层 TEC 时空网络模型通过前向时空特性传递的全局时空特性提取模块和反向时空特性传递的区域时空特性修正模块，弥补低层 STLSTM 单元的时空特性缺陷，实现电离层 TEC 全局时空特性和区域时空特性的互补，保证全球电离层 TEC 全局时空特性同时在时间域和空间域内相互传递，提高对全球电离层 TEC 的时空相关性等非线性关系的拟合性能，从而提升全球电离层 TEC 的建模与预测精度。
Huber 损失函数结合了 L1 损失函数和 L2 损失函数的优点，其相较于 L1 损失函数收敛速度更快，解更稳定；相较于 L2 损失函数具有更强的鲁棒性，对异常值不敏感。由于Huber 损失函数同时具备了 L1 损失函数和 L2 损失函数的优点，减小了对异常值的敏感度问题，实现处处可导的功能。因此，本文使用 Huber 损失函数作为全球电离层 TEC 时空网络模型训练的损失函数，约束对全球电离层 TEC 时空信息的学习过程，抑制全球电离层 TEC 数据中的粗差和噪声对预测结果的影响，同时加快网络收敛速度。

#性能验证：为了评估本项目模型的性能，使用不同时间和不同太阳活动条件下的全球电离层 TEC 数据建立数据集。最后，在不同时间点和不同太阳活动条件下，使用全球电离层 TEC 时空网络模型预测全球电离层 TEC 未来一天的变化，并与CODE 的一天预测数据、convLSTM 模型以及 PredRNN 模型的一天预测结果进行比较。在内部精度验证条件下，从量化分析结果来看，本方法的平均 RMSE、平均 MAE、平均 PSNR 均有不同程度的提高。其中，相较于 CODE、convLSTM 模型以及 PredRNN 模型，本方法的平均 RMSE 在太阳活动最大期分别提高了 21.08%、15.67%以及 9.66%；在太阳活动最小期分别提高了 38.46%、37.82%以及 13.04%。从视觉分析来看，本方法预测的全球电离层 TEC 分布更符合 IGS 最终 TEC 的分布。单独评价时间间隔为2h 的每一时刻的全球电离层 TEC 预测结果，本文方法在一天的前 12 个小时中具有更高的预测精度，相比于其他几种方法更适用于 12h 以内的短时预测。并且对于整个数据集而言，本文方法整体上比 CODE 具有更高的预测精度。在外部精度验证条件下，相较于测高卫星的 VTEC 数据，本文方法的精度与 IGS 最终TEC 的精度非常相似，在太阳活动最大期与 CODE 的预测性能相似，而在太阳活动最小期略优于 CODE 的预测性能。并且，使用 Huber 损失函数约束时空网络模型的训练过程，抑制了全球电离层 TEC 数据中的粗差和噪声，进一步提升了全球电离层 TEC 预测精度。总体上看，本项目提出的全球电离层 TEC 时空网络模型能进一步提高全球电离层 TEC 的建模与预测精度，可有效服务于卫星导航定位中的电离层延迟误差改正。

#产品介绍：每天发布的电离层产品生成流程如下：先是下载c2pg产品，经过文件读取以及数据处理，生成预测TEC所需的数据集，之后通过全球电离层 TEC 时空网络模型生成TEC的预测值，最后生成电离层预报产品。每天发布的预测电离层产品有较高的精度，可服务于导航作业。

